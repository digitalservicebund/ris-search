# 7. Using Pact Library for Contract Testing

Date: 2024-09-25

## Status

Accepted

## Context

We need to ensure that the API services are working as expected and that they are compatible with the frontend.
Types compatibility issues between the frontend and backend can lead to runtime errors and unexpected behavior.

## Decision Drivers

- **Compatibility**: Ensure that the data exchanged between the frontend and backend are compatible.
- **Reliability**: Ensure that the API services are working as expected.
- **Maintainability**: Make it easier to maintain our frontend given the changes in the API services.
- **Efficiency**: Make the testing process more efficient, discovering bugs early on.

## Considered Options

1. **Manual Testing**
    - **Pros**:
        - Simple to set up.
        - No additional dependencies.
    - **Cons**:
        - Time-consuming.
        - Error-prone.
        - Requires manual intervention.

## Decision Outcome

We will use the Pact library for contract testing.
The frontend will generate pact files, acting as a consumer, whereas the backend will verify the pact files, acting as a provider.
The pact files will contain the expected request and response data, which will be used to verify the API services.
The frontend tests can be placed next to the components that interact with the backend and the test files should follow the pattern of
`<service-name>.pact.unit.spec.ts`. 
On the backend, the tests should be placed in the package `de.bund.digitalservice.ris.search.contract.controller.api` and should be part of the integration tests.
Pact files are generated by the frontend in the root of the backend folder and are named `frontend-backend.json`.
There's a _lefthook_ git hook designed to scan for changes in the frontend, runs the pact tests and commit the new generated pact files.

### Key Changes:

- The frontend tests will generate pact files.
- The backend will verify the pact files.
- Pact files will be generated in the root of the backend folder.
- A lefthook will scan for changes in the frontend, run the pact tests and commit the new generated pact files.
